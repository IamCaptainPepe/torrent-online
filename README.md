# torrent-online — WebTorrent → VLC (плейлист одним процессом)

Утилита для стрима выбранных файлов из `.torrent`/`magnet:` в VLC. Теперь VLC запускается **один раз** со всем плейлистом, а кэш очищается **после выхода VLC** — больше не рвёт следующую серию.

## Что нового
- Один процесс VLC на все выбранные серии.
- HTTP‑сервер WebTorrent держим до конца плейлиста.
- Точная очистка кэша: по умолчанию весь каталог удаляется **после** выхода VLC; можно отключить (`--keep-cache`).
- Безопасные выходы: ловим SIGINT/SIGTERM и чистим кэш.
- Натуральная сортировка (E1, E2, …), фильтр по подстроке или `/regex/`.

## Требования
- Node.js ≥ 18
- VLC в PATH, либо `/Applications/VLC.app` на macOS

## Установка
```bash
npm i
```
или
```bash
npm i inquirer@8 webtorrent
```

## Запуск
```bash
node wtui.js
# или
./wtui.js
```

## Флаги
- `--keep-cache` — не удалять кэш после выхода VLC.
- `--network-caching=<ms>` — прокинуть значение VLC (по умолчанию 1500).

## Поток
1. Выбираешь источник: `.torrent` из текущей папки/`~/Downloads`, `magnet:`, или путь к `.torrent`.
2. Список файлов (видео) → фильтр → мультивыбор.
3. Указываешь кэш (дефолт `~/Movies/WebTorrent`).
4. Открывается VLC с плейлистом. После выхода — кэш очищается (если не `--keep-cache`).

## Известные моменты
- Порт берётся случайно из 8123..10122. Если занят — пробуем соседний.
- Для magnet‑ссылок список файлов покажется после получения metadata.
